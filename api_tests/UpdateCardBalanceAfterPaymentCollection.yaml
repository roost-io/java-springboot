# ********RoostGPT********

# Test generated by RoostGPT for test TDD-based-test using AI Type Azure Open AI and AI Model roostgpt-4-32k
# 
# ROOST_METHOD_HASH=ee492ced05
# ROOST_METHOD_SIG_HASH=b21cea14f7
# 
#    ########## Scenario ##########  
# 
# {
#   background: null,
#   rule: null,
#   scenario: 'Update the card balance once payment is collected\n' +
#     '  Given the system has started collecting payment and the payment is successful\n' +
#     '  When the client sends a POST request to "/api/creditCard/payment" with the payment status\n' +
#     '  Then the response status code should be 200\n' +
#     '  And the card balance should be updated',
#   title: 'Update the card balance once payment is collected'
# }
# 

# ********RoostGPT********
config:
  target: "{{ $processEnvironment.API_HOST }}/api"
  phases:
    - duration: 60
    - arrivalRate: 2
  payload:
    path: "UpdateCardBalanceAfterPaymentCollection.csv"
    fields:
      - "paymentAmount"
      - "creditCardNumber"
  environments:
    dev:
      API_HOST: "{{ $processEnvironment.API_HOST }}"

scenarios:
  - name: "Update the card balance once payment is collected"
    flow:
      # This script simulates a POST request to the /creditCard/payment endpoint 
      # with the provided paymentAmount and creditCardNumber
      - post:
          url: "/creditCard/payment"
          json:
            paymentAmount: "{{ paymentAmount }}"
            creditCardNumber: "{{ creditCardNumber }}"
          expect:
            # Asserting that the response status code is 200
            - statusCode: 200
            # Asserting that response has the property "balance"
            - hasProperty: "balance"
          log: "Sent POST request to /creditCard/payment with payment status, received 200 response and balance updated"
      - think: 1
