# ********RoostGPT********
# Test generated by RoostGPT for test divyesh using AI Type Azure Open AI and AI Model roost-gpt4-32k
# 
# ================================VULNERABILITIES================================
# Vulnerability: CWE-311: Missing Encryption of Sensitive Data
# Issue: Card numbers are printed in plain texts which include PII and PCI (lines 1-5).
# Solution: Encrypt sensitive data during transmission and while in storage. Use strong, up-to-date encryption algorithms and ciphers.
# 
# Vulnerability: CWE-532: Insertion of Sensitive Information into Log File
# Issue: Sensitive card information logged in the requests (lines 1-5).
# Solution: Update logging practices to exclude sensitive information. Logs should not contain PII or payment card information (PCI).
# 
# Vulnerability: GDPR Article 32: Security of Processing
# Issue: Potential non-compliance with GDPR due to unencrypted transmission of sensitive cardholder data (lines 1-5).
# Solution: Implement strong encryption for all data transmissions, ensure system configurations follow best security practices, conduct regular security audits and fully document all data handling process.
# 
# ================================================================================
# Test generated for /v1/cards/{cardId}/cardPaymentAuthenticationStatuses_post for http method type POST in artillery framework
# RoostTestHash=511084a98f
# 
# 
# ********RoostGPT********
config:
  target: "{{ $processEnvironment.API_HOST }}"
  plugins:
    expect: {}
  payload:
    path: "cardPaymentAuthenticationStatuses_post_success.csv"
    fields: 
      - "cardId"
      - "transactionId"
      - "trusteeExternalId"
      - "channelType"
      - "status"
      - "statusTimestamp"
      - "timestamp"
    skipHeader: true
  headers: 
    X-requestId: {{$uuid}}
    Authorization: "{{$processEnvironment.AUTH_TOKEN}}"
  variables:
    acceptLanguage: "en"
scenarios: 
  - name: "Successful Card Payment Authentication Statuses"
    flow: 
      # POST request to /v1/cards/{cardId}/cardPaymentAuthenticationStatuses endpoint
      - post:
          url: "/bankservice/v1/cards/{{ cardId }}/cardPaymentAuthenticationStatuses"
          headers:
            Accept-Language: "{{ acceptLanguage }}"
          json:
            transactionId: "{{ transactionId }}"
            cardId: "{{ cardId }}"
            trusteeExternalId: "{{ trusteeExternalId }}"
            channelType: "{{ channelType }}"
            status: "{{ status }}"
            statusTimestamp: "{{ statusTimestamp }}"
            timestamp: "{{ timestamp }}"
          expect:
            - statusCode: 200
            - hasProperty: "transactionId"
            - hasProperty: "cardId"
            - hasProperty: "trusteeExternalId"
            - hasProperty: "channelType"
            - hasProperty: "status"
            - hasProperty: "statusTimestamp"
            - hasProperty: "timestamp"
          capture:
            - json: "$.transactionId"
              as: "transactionId"
            - json: "$.cardId"
              as: "cardId"
      - think: 1
